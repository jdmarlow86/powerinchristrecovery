<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Power in Christ Recovery</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="hero">
    <div class="hero__overlay"></div>
    <div class="hero__content container">
      <h1>Power in Christ Recovery</h1>
      <p class="tagline">Finding Strength, Grace, and Renewal in Jesus</p>
      <p class="intro">
        Power in Christ Recovery is a Christ-centered approach to renewal and healing. We believe freedom begins not with
        self-will, but with surrender — and that every struggle can be transformed by God's grace.
      </p>
      <blockquote class="scripture">
        “My grace is sufficient for you, for My power is made perfect in weakness.”<br />
        <cite>— 2 Corinthians 12:9</cite>
      </blockquote>

      <div class="support" data-support>
        <button
          class="support__button"
          type="button"
          aria-haspopup="dialog"
          aria-expanded="false"
          aria-controls="support-modal"
        >
          Support This Ministry
        </button>
        <div
          class="support__content"
          data-support-content
          id="support-modal"
          role="dialog"
          aria-modal="true"
          aria-labelledby="support-modal-title"
          hidden
        >
          <div class="support__panel">
            <h2 class="support__title" id="support-modal-title">Support This Ministry</h2>
            <p class="support__subtitle">Choose your preferred platform:</p>
            <ul class="support__list">
              <li>
                <a
                  class="support__link support__link--cashapp"
                  href="https://cash.app/$jdmarlow"
                  target="_blank"
                  rel="noopener"
                  aria-label="Support via Cash App: $jdmarlow"
                  >Cash App</a
                >
              </li>
              <li>
                <a
                  class="support__link support__link--venmo"
                  href="https://venmo.com/u/Jonathan-Marlow-19"
                  target="_blank"
                  rel="noopener"
                  aria-label="Support via Venmo: @Jonathan-Marlow-19"
                  >Venmo</a
                >
              </li>
              <li>
                <a
                  class="support__link support__link--paypal"
                  href="https://www.paypal.com/paypalme/jdmarlow86"
                  target="_blank"
                  rel="noopener"
                  aria-label="Support via PayPal: @jdmarlow86"
                  >PayPal</a
                >
              </li>
            </ul>
            <p class="support__note" data-hide-in-popup>
              If you don't see a popup window, your browser may have blocked it. The support options are shown here as a fallback.
            </p>
          </div>
        </div>
        <noscript>
          <div class="support__content support__content--static">
            <div class="support__panel">
              <h2 class="support__title">Support This Ministry</h2>
              <p class="support__subtitle">Choose your preferred platform:</p>
              <ul class="support__list">
                <li>
                  <a
                    class="support__link support__link--cashapp"
                    href="https://cash.app/$jdmarlow"
                    target="_blank"
                    rel="noopener"
                    aria-label="Support via Cash App: $jdmarlow"
                    >Cash App</a
                  >
                </li>
                <li>
                  <a
                    class="support__link support__link--venmo"
                    href="https://venmo.com/u/Jonathan-Marlow-19"
                    target="_blank"
                    rel="noopener"
                    aria-label="Support via Venmo: @Jonathan-Marlow-19"
                    >Venmo</a
                  >
                </li>
                <li>
                  <a
                    class="support__link support__link--paypal"
                    href="https://www.paypal.com/paypalme/jdmarlow86"
                    target="_blank"
                    rel="noopener"
                    aria-label="Support via PayPal: @jdmarlow86"
                    >PayPal</a
                  >
                </li>
              </ul>
            </div>
          </div>
        </noscript>
      </div>
    </div>
  </header>

  <main>
    <section class="section container" aria-labelledby="meeting-flow">
      <div class="section__header">
        <h2 id="meeting-flow">Weekly Meeting Flow</h2>
        <p class="section__subtitle">A grace-filled rhythm to gather, share, and grow.</p>
      </div>
      <ol class="list list--numbered">
        <li>Welcome &amp; Opening Prayer</li>
        <li>Scripture Reflection</li>
        <li>Focus Step Discussion</li>
        <li>Group Sharing</li>
        <li>Prayer &amp; Commitment</li>
        <li>Fellowship / Coffee &amp; Support</li>
      </ol>
      <p class="principles">
        <strong>Key Principles:</strong> Confidentiality, listening with grace, and letting Christ lead in love.
      </p>
    </section>

    <section class="section section--muted" aria-labelledby="recovery-steps">
      <div class="container">
        <div class="section__header">
          <h2 id="recovery-steps">The 10 Recovery Steps</h2>
          <p class="section__subtitle">Walk with Christ through a journey of surrender, healing, and mission.</p>
        </div>
        <div class="steps-grid">
          <article class="step-card">
            <h3>1. Surrender &amp; Honesty</h3>
            <p>Admit the struggle and invite God in.</p>
          </article>
          <article class="step-card">
            <h3>2. Safety &amp; Rhythm</h3>
            <p>Create daily spiritual routines.</p>
          </article>
          <article class="step-card">
            <h3>3. Confession &amp; Clean-Up</h3>
            <p>Clear your heart and environment.</p>
          </article>
          <article class="step-card">
            <h3>4. Triggers &amp; Replacement</h3>
            <p>Replace the old with holy focus.</p>
          </article>
          <article class="step-card">
            <h3>5. Scripture &amp; Prayer Habits</h3>
            <p>Feed your spirit daily.</p>
          </article>
          <article class="step-card">
            <h3>6. Community &amp; Mentor</h3>
            <p>Walk with those who lift you up.</p>
          </article>
          <article class="step-card">
            <h3>7. Inventory &amp; Amends</h3>
            <p>Make things right, step by step.</p>
          </article>
          <article class="step-card">
            <h3>8. Boundaries &amp; Guardrails</h3>
            <p>Protect what God restores.</p>
          </article>
          <article class="step-card">
            <h3>9. Service &amp; Mission</h3>
            <p>Turn healing into helping.</p>
          </article>
          <article class="step-card">
            <h3>10. Long-Term Maintenance</h3>
            <p>Remain in Christ; continue growing.</p>
          </article>
        </div>
      </div>
    </section>

    <section class="section container" aria-labelledby="closing-prayer">
      <div class="section__header">
        <h2 id="closing-prayer">Closing Prayer</h2>
      </div>
      <p class="prayer">
        Lord, make me willing to be healed, to walk humbly and rely on Your power. Strengthen my steps, forgive my
        stumbles, and guide me toward lasting freedom. Amen.
      </p>
    </section>

    <section class="section section--chapter" aria-labelledby="create-chapter">
      <div class="container chapter">
        <div class="section__header">
          <h2 id="create-chapter">Create a Chapter</h2>
          <p class="section__subtitle">Bring the Power in Christ Recovery journey to your city or church.</p>
        </div>
        <div class="chapter__grid">
          <div class="chapter__content">
            <p>
              Launching a new chapter begins with prayer, preparation, and a heart to serve. Use these steps to
              establish a grace-filled recovery community where you are:
            </p>
            <ul class="chapter__list">
              <li><strong>Pray &amp; Discern:</strong> Gather a small team committed to interceding for your community.</li>
              <li><strong>Secure a Location:</strong> Partner with a local church or ministry space that can host weekly meetings.</li>
              <li><strong>Equip Your Team:</strong> Review the Power in Christ 10-Step resources and identify leaders for prayer,
                hospitality, and follow-up.</li>
              <li><strong>Share the Vision:</strong> Invite pastors, mentors, and potential participants to learn about the program
                and its Christ-centered approach.</li>
            </ul>
          </div>
          <aside class="chapter__card" aria-labelledby="chapter-contact">
            <h3 id="chapter-contact">Ready to Begin?</h3>
            <p>
              Email us with your location, church or ministry partner, and desired launch timeline. We'll send you
              onboarding materials, coaching support, and promotional tools tailored to your needs.
            </p>
            <p class="chapter__contact">
              <strong>Contact:</strong>
              <a href="mailto:mybiblebelt@gmail.com">mybiblebelt@gmail.com</a>
            </p>
          </aside>
        </div>
      </div>
    </section>

    <section class="section section--accent" aria-labelledby="connect">
      <div class="container connect">
        <div class="section__header">
          <h2 id="connect">Connect &amp; Next Steps</h2>
        </div>
        <div class="connect__content">
          <ul class="list list--plain">
            <li><strong>Join a meeting:</strong> Your local church or city</li>
            <li><strong>Visit:</strong> <a href="https://mybiblebelt.org/recovery" target="_blank" rel="noopener">mybiblebelt.org/recovery</a></li>
            <li>
              <strong>Start a group:</strong>
              <a href="assets/Recovery_Power_in_Christ_10_Step_Plan.pdf" download>Download the Leader Guide &amp; Journal</a>
            </li>
            <li>
              <strong>Follow-Up Resources:</strong>
              <a href="https://www.bible.com/reading-plans" target="_blank" rel="noopener">Explore a Bible.com reading plan</a>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <section class="section newsletter" aria-labelledby="newsletter">
      <div class="container newsletter__grid">
        <div class="newsletter__content">
          <h2 id="newsletter">Weekly Encouragement in Your Inbox</h2>
          <p>
            Subscribe to receive a short weekly update with prayer prompts, Scripture meditations, and ministry news to help
            you stay rooted in Christ throughout the week.
          </p>
        </div>
        <form class="newsletter__form" data-newsletter-form novalidate>
          <label class="newsletter__label" for="newsletter-email">Email address</label>
          <div class="newsletter__field">
            <input
              class="newsletter__input"
              type="email"
              id="newsletter-email"
              name="email"
              placeholder="you@example.com"
              autocomplete="email"
              required
            />
            <button class="newsletter__button" type="submit">Sign Up</button>
          </div>
          <p class="newsletter__privacy">We'll send one email each week. Unsubscribe at any time.</p>
          <p class="newsletter__confirmation" data-newsletter-message hidden role="status" aria-live="polite">
            Thanks for subscribing! Please check your inbox for a welcome message.
          </p>
          <p class="newsletter__error" data-newsletter-error hidden role="status" aria-live="assertive">
            Sorry, we couldn't send your welcome email. Please try again in a moment.
          </p>
        </form>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <p>&copy; <span id="year"></span> Power in Christ Recovery. All rights reserved.</p>
    </div>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    const support = document.querySelector('[data-support]');
    if (support) {
      const button = support.querySelector('.support__button');
      const content = support.querySelector('[data-support-content]');
      let previousPopup = null;

      if (!button || !content) {
        if (content) {
          content.hidden = false;
          content.removeAttribute('hidden');
        }
      } else {
        const stylesheet = document.querySelector('link[rel="stylesheet"][href$="styles.css"]');

        const getPopupMarkup = () => {
          const clone = content.cloneNode(true);
          clone.removeAttribute('hidden');
          clone.querySelectorAll('[data-hide-in-popup]').forEach((node) => node.remove());
          return clone.innerHTML;
        };

        const showInlineSupport = () => {
          content.hidden = false;
          content.removeAttribute('hidden');
          button.setAttribute('aria-expanded', 'true');
        };

        const hideInlineSupport = () => {
          content.hidden = true;
          content.setAttribute('hidden', '');
          button.setAttribute('aria-expanded', 'false');
        };

        const openSupportWindow = () => {
          const width = 480;
          const height = 520;
          const left = Math.round(window.screenX + Math.max((window.outerWidth - width) / 2, 0));
          const top = Math.round(window.screenY + Math.max((window.outerHeight - height) / 2, 0));
          const features = `width=${width},height=${height},left=${left},top=${top},resizable=yes,scrollbars=yes`;
          if (previousPopup && !previousPopup.closed) {
            try {
              previousPopup.close();
            } catch (error) {
              console.error('Unable to close previous support window:', error);
            }
          }

          const popupName = `supportOptions-${Date.now()}`;
          const popup = window.open('', popupName, features);

          if (!popup) {
            return null;
          }

          const markup = getPopupMarkup();
          const stylesheetHref = stylesheet ? stylesheet.getAttribute('href') : null;

          try {
            popup.document.open();
            popup.document.write(`<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Support This Ministry</title>
    ${stylesheetHref ? `<link rel="stylesheet" href="${stylesheetHref}">` : ''}
  </head>
  <body class="support__window">
    <main class="support__window-main">
      ${markup}
    </main>
  </body>
</html>`);
            popup.document.close();

            popup.addEventListener('load', () => {
              const firstLink = popup.document.querySelector('.support__list a');
              if (firstLink) {
                firstLink.focus();
              }
            });

            popup.focus();
            previousPopup = popup;
            return popup;
          } catch (error) {
            console.error('Unable to render support window:', error);
            try {
              popup.close();
            } catch (closeError) {
              console.error('Unable to close failed support window:', closeError);
            }
            return null;
          }
        };

        button.addEventListener('click', () => {
          const popup = openSupportWindow();

          if (!popup) {
            if (content.hasAttribute('hidden')) {
              showInlineSupport();
            } else {
              hideInlineSupport();
            }
          } else {
            hideInlineSupport();
          }
        });
      }
    }

    window.addEventListener('unhandledrejection', (event) => {
      const reason = event?.reason;
      if (reason && /MetaMask extension not found/i.test(reason.message || reason)) {
        event.preventDefault();
        console.info('MetaMask extension not detected; wallet connection skipped.');
      }
    });

    const newsletterForm = document.querySelector('[data-newsletter-form]');
    if (newsletterForm) {
      const emailInput = newsletterForm.querySelector('input[type="email"]');
      const message = newsletterForm.querySelector('[data-newsletter-message]');
      const errorMessage = newsletterForm.querySelector('[data-newsletter-error]');
      const submitButton = newsletterForm.querySelector('button[type="submit"]');
      const submitButtonLabel = submitButton ? submitButton.textContent : '';

      const toggleMessage = (element, shouldShow) => {
        if (!element) return;
        element.hidden = !shouldShow;
      };

      const sendWelcomeEmail = async (emailAddress) => {
        const endpointBase = 'https://formsubmit.co/ajax/';
        const welcomeLines = [
          'Hi there,',
          '',
          'Thank you for signing up to receive weekly encouragement from Power in Christ Recovery.',
          'We are honored to walk alongside you in prayer, Scripture reflection, and Christ-centered support.',
          '',
          'Each week you can expect:',
          '• A short devotional focus rooted in God\'s Word.',
          '• A prayer prompt to carry with you through the week.',
          '• Ministry updates and opportunities to stay connected.',
          '',
          'We are praying for you. May the peace of Christ guard your heart as you continue this journey toward freedom.',
          '',
          'Grace and peace,',
          'Power in Christ Recovery'
        ];

        const payload = {
          email: emailAddress,
          message: welcomeLines.join('\n'),
          _subject: 'Welcome to Power in Christ Recovery',
          _bcc: 'jonmarlow@gmail.com',
          _template: 'table'
        };

        const response = await fetch(`${endpointBase}${encodeURIComponent(emailAddress)}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            Accept: 'application/json'
          },
          body: JSON.stringify(payload)
        });

        if (!response.ok) {
          throw new Error('Failed to send welcome email');
        }

        return response.json();
      };

      newsletterForm.addEventListener('submit', async (event) => {
        event.preventDefault();

        if (emailInput && !emailInput.checkValidity()) {
          emailInput.reportValidity();
          return;
        }

        const emailAddress = emailInput ? emailInput.value.trim() : '';
        if (!emailAddress) {
          return;
        }

        toggleMessage(message, false);
        toggleMessage(errorMessage, false);

        if (submitButton) {
          submitButton.disabled = true;
          submitButton.textContent = 'Sending…';
        }

        try {
          await sendWelcomeEmail(emailAddress);
          newsletterForm.reset();
          toggleMessage(message, true);
        } catch (error) {
          console.error('Newsletter signup error:', error);
          toggleMessage(errorMessage, true);
          if (emailInput) {
            emailInput.focus();
          }
        } finally {
          if (submitButton) {
            submitButton.disabled = false;
            submitButton.textContent = submitButtonLabel;
          }

          window.setTimeout(() => {
            toggleMessage(message, false);
            toggleMessage(errorMessage, false);
          }, 8000);
        }
      });
    }
  </script>
</body>
</html>
